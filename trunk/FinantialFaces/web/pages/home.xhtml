<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition   xmlns:ui="http://java.sun.com/jsf/facelets"
                  xmlns="http://www.w3.org/1999/xhtml"
                  template="/template/main-template.xhtml"
                  xmlns:p="http://primefaces.prime.com.tr/ui"
                  xmlns:h="http://java.sun.com/jsf/html"
                  xmlns:f="http://java.sun.com/jsf/core"
                  xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:define name="head">

            <ui:param name="menu" value="1"/>
        </ui:define>
    <ui:define name="theme"/>

    <ui:define name="content">
    <ui:param name="menu" value="1"/>
        <h:form id="main_form" prependId="false">

            <p:outputPanel id="tab_panel" >
                <p:panel header="Visualizar Finanças"  >

                    <p:tabView id="tabs" dynamic="false" activeIndex="#{tabService.yearTabIndex}">
                <c:forEach id="fe" var="y" items="#{tabBean.tabYears}">
                    <p:tab title="#{y.title}" >
                        <p:tabView  dynamic="false" activeIndex="#{tabService.monthTabIndex}" style="min-width: 100%;width: auto;min-height: 300px" >
                            <c:forEach var="m" items="#{y.finantialMonths}">
                                <p:tab title="#{msg[m.title]}" >
<!--                                     <p:fieldset legend="#{msg['finance.label.legend']}">-->
                                    <table width="100%">
                                             <td width="50%" align="left">
                                                  <p:outputPanel id="receitas_#{y.title.concat(msg[m.title])}">
                                                      <p:panel  header="Receitas" toggleable="true" style="text-align: center" toggleSpeed="700">
                                                     <p:dataTable  var="r" dynamic="false" value="#{m.currentUserIncomesInTheMonth}" rendered="#{not empty m.currentUserIncomesInTheMonth}" paginator="true" rows="5"
                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,15" style="border: none">
                                                         <p:column selectionMode="multiple" />
                                                         <p:column resizable="true" sortBy="#{r.date}" parser="date" >
                                                             <f:facet name="header">
                                                                 <h:outputLabel value="#{msg['finance.label.data']}"/>
                                                             </f:facet>
                                                             <p:commandLink style="text-decoration: none" action="#{addBean.editReceita(r)}" oncomplete="editModal.show()" update="edit_finance" process="receitas_#{y.title.concat(msg[m.title])}">
                                                                    <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}" value="#{r.date}">
                                                                     <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                                    </h:outputText>
                                                                </p:commandLink>
                                                         </p:column>
                                                         <p:column resizable="true">
                                                             <f:facet name="header">
                                                                 <h:outputLabel value="#{msg['login.label.username']}"/>
                                                             </f:facet>
                                                             <p:commandLink  style="text-decoration: none" action="#{addBean.editReceita(r)}" oncomplete="editModal.show()" update="edit_finance" process="receitas_#{y.title.concat(msg[m.title])}">
                                                                 <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}" value="#{r.user}"/>
                                                             </p:commandLink>
                                                         </p:column>
                                                         <p:column resizable="true">
                                                             <f:facet name="header">
                                                                 <h:outputLabel value="#{msg['finance.label.descricao']}"/>
                                                             </f:facet>
                                                             <p:commandLink style="text-decoration: none"  action="#{addBean.editReceita(r)}" oncomplete="editModal.show()" update="edit_finance" process="receitas_#{y.title.concat(msg[m.title])}">
                                                                 <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}" value="#{r.description}"/>
                                                             </p:commandLink>
                                                         </p:column>
                                                          <p:column resizable="true">
                                                             <f:facet name="header">
                                                                <h:outputLabel value="#{msg['finance.label.tipo']}"/>
                                                             </f:facet>
                                                              <p:commandLink style="text-decoration: none" action="#{addBean.editReceita(r)}" oncomplete="editModal.show()" update="edit_finance" process="receitas_#{y.title.concat(msg[m.title])}">
                                                                  <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}" value="#{msg['subtipo.income.'.concat(r.type)]}"/>
                                                              </p:commandLink>
                                                         </p:column>
                                                         <p:column resizable="true" sortBy="#{r.value}" parser="number">
                                                             <f:facet name="header">
                                                                #{msg['finance.label.valor']}
                                                             </f:facet>
                                                             <p:commandLink style="text-decoration: none"  action="#{addBean.editReceita(r)}" oncomplete="editModal.show()" update="edit_finance" process="receitas_#{y.title.concat(msg[m.title])}">
                                                                 <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-white': ''}" value="#{r.value}"/>
                                                             </p:commandLink>
                                                         </p:column>

                                                          <f:facet name="footer">
                                                               <table width="100%">
                                                                     <tr>
                                                                     <td align="left">
                                                                         <p:commandButton title="incluir receita para o mês" value="Incluir Receita"/>
                                                                     </td>
                                                                         <td align="center">
                                                                             <p:panel style="min-width: 150px;width: auto;min-height: 28px;height: auto">
                                                                                 <h:outputLabel style="font-weight: bold" for="total_depesa" value="#{msg['finance.label.total']}:"/>
                                                                                 <h:outputLabel style="padding-left: 5px;color:#{themeService.themeProperties.FINANCE_FOOTER_COLOR}" id="total_depesa" value="#{m.totalIncomeInTheMonth}"/>
                                                                             </p:panel>
                                                                         </td>
                                                                     <td align="right">
                                                                         <p:commandButton value="Remover Selecionados"/>
                                                                     </td>
                                                                      </tr>
                                                                </table>
                                                             </f:facet>

                                                     </p:dataTable>
                                                     <div align="center">
                                                         <h:outputText value="Nenhuma receita cadastrada" style="color: red;font-size: 14px" rendered="#{empty m.currentUserIncomesInTheMonth}"/>
                                                     </div>
                                                 </p:panel>
                                            </p:outputPanel>
                                             </td>
                                             <td  width="50%" align="right">
                                                 <p:outputPanel id="despesas_#{y.title.concat(msg[m.title])}">
                                                 <p:panel header="Despesas"  style="text-align: center" toggleable="true" toggleSpeed="700">
                                                     <p:dataTable rowStyleClass="teste"  var="d" onRowSelectUpdate="edit_grid_despesa" selectionMode="single" rowSelectListener="#{addBean.onSelectOutcome}" onRowSelectComplete="editModal.show()" value="#{m.currentUserOutcomesInTheMonth}" selection="#{addBean.despesa}" rendered="#{not empty m.currentUserOutcomesInTheMonth}"  paginator="true" rows="5"
                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,15" style="border: none">
                                                         <p:column sortBy="#{d.date}" parser="date" >
                                                             <f:facet name="header">
                                                                 <h:outputLabel value="#{msg['finance.label.data']}"/>
                                                             </f:facet>
                                                             <p:commandLink title="#{msg['finance.tooltip.edit-remove']}" style="text-decoration: none">
                                                                    <h:outputText value="#{d.date}" styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}">
                                                                     <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                                    </h:outputText>
                                                                </p:commandLink>
                                                         </p:column>
                                                         <p:column resizable="true">
                                                             <f:facet name="header">
                                                                 <h:outputLabel value="#{msg['login.label.username']}"/>
                                                             </f:facet>
                                                             <p:commandLink title="#{msg['finance.tooltip.edit-remove']}" style="text-decoration: none">
                                                                 <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}" value="#{d.user}"/>
                                                             </p:commandLink>

                                                         </p:column>
                                                         <p:column resizable="true">
                                                             <f:facet name="header">
                                                                 <h:outputLabel value="#{msg['finance.label.descricao']}"/>
                                                             </f:facet>
                                                             <p:commandLink title="#{msg['finance.tooltip.edit-remove']}" style="text-decoration: none">
                                                                 <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}" value="#{d.description}"/>
                                                             </p:commandLink>
                                                         </p:column>
                                                          <p:column resizable="true">
                                                             <f:facet name="header">
                                                                #{msg['finance.label.tipo']}
                                                             </f:facet>
                                                              <p:commandLink title="#{msg['finance.tooltip.edit-remove']}" style="text-decoration: none">
                                                                  <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-orange': ''}" value="#{msg['subtipo.outcome.'.concat(d.type)]}"/>
                                                              </p:commandLink>
                                                         </p:column>
                                                         <p:column resizable="true" sortBy="#{d.value}" parser="number">
                                                             <f:facet name="header">
                                                                #{msg['finance.label.valor']}
                                                             </f:facet>
                                                             <p:commandLink title="#{msg['finance.tooltip.edit-remove']}" styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-white': ''}">
                                                                 <h:outputText styleClass="#{themeService.theme eq 'ui-darkness' ? 'link-white': ''}" value="#{d.value}"/>
                                                             </p:commandLink>
                                                         </p:column>

                                                             <f:facet name="footer" >
                                                                 <table width="100%">
                                                                     <tr>
                                                                         <td align="left">
                                                                             <p:commandButton title="#{msg['finance.tooltip.add-outcome']}" id="newOutcome" value="Nova Despesa">
                                                                             </p:commandButton>
                                                                            
                                                                         </td>
                                                                         <td align="center">

                                                                         </td>
                                                                         <td align="right" >
                                                                             <p:panel style="min-width: 100px;max-width: 150px;min-height: 25px;height: auto ">
                                                                                 <div align="center">
                                                                                     <h:outputLabel style="font-weight: bold" for="total_depesa" value="#{msg['finance.label.total']}:"/>
                                                                                     <h:outputLabel style="padding-left: 5px;color:#{themeService.themeProperties.FINANCE_FOOTER_COLOR}" id="total_depesa" value="#{m.totalOutcomeInTheMonth}"/>
                                                                                 </div>
                                                                             </p:panel>
                                                                         </td>
                                                                     </tr>
                                                                </table>
                                                             </f:facet>

                                                     </p:dataTable>
                                                     <div align="center">
                                                         <h:outputText value="Nenhuma despesa cadastrada" style="color: red;font-size: 14px" rendered="#{empty m.currentUserOutcomesInTheMonth}"/>
                                                     </div>
                                                 </p:panel>
                                              </p:outputPanel>

                                             </td>



                                         </table>


<!--                                    </p:fieldset>-->

                                </p:tab>
                            </c:forEach>

                            </p:tabView>
                    </p:tab>
                </c:forEach>
            </p:tabView>
                    </p:panel>
         </p:outputPanel>
             <p:outputPanel id="include_finance">
                 <ui:include src="add-financa.xhtml"/>
             </p:outputPanel>
            <p:tooltip global="true" showEffect="slide"  hideEffect="slide"/>

        </h:form>
             <p:outputPanel id="edit_finance">
                 <p:dialog  modal="true" widgetVar="editModal" header="Editar" showEffect="fold"  hideEffect="explode" minHeight="150" closable="true" draggable="true">
                     <h:form prependId="false">
                          <ui:include src="edit-financa.xhtml"/>
                     </h:form>
                 </p:dialog>
             </p:outputPanel>
    </ui:define>

</ui:composition>
